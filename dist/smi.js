"use strict";var Smi=function(){var t={renderNum:0,data:{}};t.getIns=function(e){return e instanceof Array?e.map(function(e){return t.data[e]}):t.data[e]},t.getHigherIDs=function(t){var e=t,n=[];for(n.push(e);e=e.slice(0,-2);)n.push(e);return n},t.setIns=function(e,n){t.data[e]=n};var e={};e.__attr__=["class","data","style","id","src","name","value","href"],e.each=function(t){this.__attr__.forEach(function(e){t(e)})};var n={};n.deepCopy=function(t,e){return Object.keys(e).forEach(function(n){if(Object.getPrototypeOf(e[n])===Object.prototype)"_style_"===n&&t[n]&&Object.getPrototypeOf(t[n])===Object.prototype||(t[n]={}),this.deepCopy(t[n],e[n]);else try{t[n]=e[n]}catch(o){t={},t[n]=e[n],console.warn("the object copyTo may not be a object")}}.bind(this)),t},n.Content=function(t,e){this.value=e,this.initInfo=void 0!==t?t:"computed"},n.diff=function(t,e){var n,o;return void 0===t&&(t=e instanceof Array?[]:Object.getPrototypeOf(e)===Object.prototype?{}:" "),t instanceof Array&&e instanceof Array?(n=[],o=[],t.forEach(function(t){e.some(function(e){return t==e})||o.push(t)}),e.forEach(function(e){t.some(function(t){return e==t})||n.push(e)}),0===n.length&&0===o.length?!0:{"+":n,"-":o}):Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype?(n={},o=[],Object.keys(t).forEach(function(a){if(void 0===e[a])o.push(a);else{if(e[a]===t[a])return;n[a]=e[a]}}),Object.keys(e).forEach(function(o){if(void 0===t[o])n[o]=e[o];else if(e[o]===t[o])return}),0===Object.keys(n).length&&0===o.length?!0:{"+":n,"-":o}):"string"==typeof t&&"string"==typeof e?t===e?!0:{"+":e}:!1},n.update=function(o){(function a(){e.each(function(t){var e,o,a=this;if(void 0!==(e=this.prop["_"+t+"_"])&&(o=n.diff(this.__currentState__[t],e),o!==!0)){var r={};if(r[t]=o,this.__opNum__.push(r),o["+"]instanceof Array)this.__currentState__[t]=e.slice();else if("string"==typeof o["+"])this.__currentState__[t]=e;else{var i=Object.keys(o["+"]),s=o["-"];i.forEach(function(n){a.__currentState__[t][n]=e[n]}),s.forEach(function(e){delete a.__currentState__[t][e]})}}}.bind(this)),0!==this.__opNum__.length&&(this.__opNum__.forEach(function(t){var e=Object.keys(t)[0];this.__op__(e,"+")(t[e]["+"]),this.__op__(e,"-")(t[e]["-"])}.bind(this)),this.__opNum__=[]);var o=this.content(),r=t.getIns(this.__currentState__.content);o instanceof Array?o.forEach(function(t,e){t instanceof i&&t.__compT==r[e].initInfo.__compT?(void 0!==t.__dataAdd&&r[e].value.setPropData(t.__dataAdd),a.call(r[e].value)):r[e].initInfo!=t&&(r[e].initInfo=t,r[e].value.nodeValue=t)}):o instanceof i?(void 0!==o.__dataAdd&&r[0].value.setPropData(o.__dataAdd),a.call(r[0].value)):r[0].initInfo!=o&&(r[0].initInfo=o,r[0].value.nodeValue=o)}).call(o)};var o=function(t){this.nativeEvent=t,this.bubbles=!0,this.cancelable=t.cancelable,this.defaultPrevented=!1,this.preventDefault=t.preventDefault.bind(t),this.type=t.type,this.isTrusted=t.isTrusted,this.target=t.target,this.timeStamp=t.timeStamp,this.init()};o.Type={Clipboard:["clipboardData"],Composition:["data"],Keyboard:["altKey","charCode","ctrlKey","key","keyCode","locale","location","metaKey","repeat","shiftKey","which"],Focus:["relatedTarget"],UI:["detail","view"],Wheel:["deltaMode","deltaX","deltaY","deltaZ"],Touch:["altKey","changedTouches","ctrlKey","metaKey","shiftKey","targetTouches","touches"],Mouse:["altKey","button","buttons","clientX","clientY","ctrlKey","metaKey","pageX","pageY","relatedTarget","screenX","screenY","shiftKey","offsetX","offsetY","getModifierState"],Form:[]},o.Event={copy:"Clipboard",cut:"Clipboard",paste:"Clipboard",compositionend:"Composition",compositionstart:"Composition",compositionupdate:"Composition",keydown:"Keyboard",keypress:"Keyboard",keyup:"Keyboard",focus:"Focus",blur:"Focus",scroll:"UI",wheel:"Wheel",mousedown:"Mouse",mouseup:"Mouse",mousemove:"Mouse",click:"Mouse",dblclick:"Mouse",mouseover:"Mouse",mouseout:"Mouse",mouseenter:"Mouse",mouseleave:"Mouse",contextmenu:"Mouse",touchstart:"Touch",touchend:"Touch",touchmove:"Touch",touchcancel:"Touch",change:"Form",submit:"Form",input:"Form",select:"Form"},o.prototype.init=function(){var t=this;o.Type[o.Event[this.type]].forEach(function(e){t[e]=t.nativeEvent[e]})},o.prototype.stopPropagation=function(){this.bubbles=!1},o.prototype.preventDefault=function(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()};var a=function(){this.rawEvents={},this.compEvents={}};a.CompEvent=["didmount"],a.prototype.hasAdd=function(t){return this.rawEvents.hasOwnProperty(t)},a.prototype.evtFunc=function(e){var n=this;return function(a){for(var r,i=a.target.dataset.smiid,s=t.getHigherIDs(i),c=new o(a),_=0;_<s.length&&(r=s[_],!n.rawEvents[e].hasOwnProperty(r)||(c.currentTarget=t.getIns(r).value,n.rawEvents[e][r](c),c.bubbles));_++);}},a.prototype.push=function(e,n){var o=this,r=t.getIns(e).value,i=void 0===n?!1:t.getIns(n).value;for(var s in r.__eventHandle__)this.hasAdd(s)||(this.rawEvents[s]={}),i===!1?this.rawEvents[s][e]=r.__eventHandle__[s]:this.rawEvents[s][e]=r.__eventHandle__[s].bind(i);a.CompEvent.forEach(function(t){r.fns.hasOwnProperty(t)&&(o.compEvents.hasOwnProperty(t)||(o.compEvents[t]={}),o.compEvents[t][e]=r.fns[t].bind(r))})},a.prototype.remove=function(t,e){this.rawEvents[e][t]&&delete this.rawEvents[e][t]},a.prototype.start=function(e){this.push(e),this.root=t.getIns(e).value.__raw__;var n;for(n in this.rawEvents)this.root.addEventListener(n,this.evtFunc(n),!1);for(n in this.compEvents.didmount)this.compEvents.didmount[n]()};var r=function(t,e,n){t.prop=t.prop||{},this.__prop__=t.prop,this.fns=t.fns||{},this.content=t.content||function(){},this.setPropData(e),this.prop._raw_=this.prop._raw_||"div",this.__raw__=document.createElement(this.prop._raw_),this.__eventHandle__=n,this.__currentState__={},this.__opNum__=[]};r.prototype.__op__=function(t,e){function n(t,n){switch(e){case"+":return function(e){void 0!==e&&t.call(o,e)};case"-":return function(t){void 0!==t&&n.call(o,t)}}}var o=this;switch(t){case"class":return n(function(t){t instanceof Array?t.forEach(function(t){this.__raw__.classList.add(t)}.bind(this)):this.__raw__.classList.add(t)},function(t){t instanceof Array?t.forEach(function(t){this.__raw__.classList.remove(t)}.bind(this)):this.__raw__.classList.remove(t)});case"data":return n(function(t){Object.keys(t).forEach(function(e){this.__raw__.dataset[e]=t[e]}.bind(this))},function(t){t instanceof Array?t.forEach(function(t){this.__raw__.dataset[t]="",delete this.__raw__.dataset[t]}.bind(this)):(this.__raw__.dataset[item]="",delete this.__raw__.dataset[t])});case"style":return n(function(t){Object.keys(t).forEach(function(e){this.__raw__.style[e]=t[e]}.bind(this))},function(t){t instanceof Array?t.forEach(function(t){this.__raw__.style[t]=""}.bind(this)):this.__raw__.style[t]=""});default:return n(function(e){this.__raw__[t]=e},function(e){this.__raw__[t]=""})}},r.prototype.update=function(){n.update(this)},r.prototype.setPropData=function(t){this.prop=n.deepCopy(n.deepCopy({},this.__prop__),t)},r.prototype.off=function(){};var i=function(t,e,n){this.__compT=t,this.__dataAdd=e,this.__eventHandle=n},s=function(t){return function(e,n){return e=e||{},n=n||{},new i(t,e,n)}},c=function(o,s){var c=function p(o,a){var s=function(e){var o=a+"."+c++;if(void 0===e&&(console.warn("lack of any required parameter"),e="undefined"),e instanceof i){var r=p(e,o);u.__currentState__.content.push(o),_.push(o,a),u.__raw__.appendChild(r.__raw__)}else try{var s=document.createTextNode(e);t.setIns(o,new n.Content(e,s)),u.__currentState__.content.push(o),u.__raw__.appendChild(s)}catch(h){console.warn(h)}},c=0,u=new r(o.__compT,o.__dataAdd,o.__eventHandle);t.setIns(a,new n.Content(o,u)),u.__id__=a,u.__op__("data","+")({smiid:a}),e.each(function(t){var e;if(void 0!==(e=u.prop["_"+t+"_"])){switch(t){case"style":case"data":u.__currentState__[t]={},n.deepCopy(u.__currentState__[t],e);break;case"class":u.__currentState__[t]=e.slice();break;default:u.__currentState__[t]=e}u.__op__(t,"+")(e)}});var h=u.content();return u.__currentState__.content=[],void 0===h&&(console.warn("lack of any required parameter"),h="undefined"),h instanceof Array?h.forEach(function(t){s(t)}):s(h),u},_=new a,u=t.renderNum++,h=c(o,u+"");_.start(u),s.appendChild(h.__raw__)};return{deF:s,render:c}}();
//# sourceMappingURL=smi.js.map
